<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é­”æ³•å¥‘ç´„å¯©åˆ¤ - è‡ªå‹•æ¸¬è©•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 4px; }
        .console-text { font-family: 'Menlo', 'Monaco', 'Courier New', monospace; }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 min-h-screen p-8 flex justify-center items-start">

    <div class="w-full max-w-3xl space-y-6">
        
        <div class="bg-gray-800 rounded-xl shadow-lg border border-gray-700 overflow-hidden">
            <header class="bg-purple-900/80 p-6 border-b border-purple-700/50 flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-white flex items-center gap-2">
                        âš–ï¸ å¥‘ç´„å¯©åˆ¤è€… (The Judge)
                    </h1>
                    <p class="text-purple-200 text-sm mt-1 opacity-80">Validation Logic Checker</p>
                </div>
                <div id="status-badge" class="px-4 py-2 rounded-lg font-bold bg-gray-700 text-gray-400 text-sm">
                    Ready
                </div>
            </header>

            <div id="test-list" class="p-6 space-y-3"></div>

            <div class="p-4 bg-gray-900/50 border-t border-gray-700 flex justify-end gap-3">
                <button onclick="runTests()" class="px-6 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded shadow-lg font-bold transition-transform hover:scale-105">
                    é–‹å§‹å¯©åˆ¤
                </button>
            </div>
        </div>

        <div class="bg-black rounded-xl shadow-lg border border-gray-700 overflow-hidden font-mono text-xs md:text-sm h-64 flex flex-col">
            <div class="bg-gray-800 px-4 py-2 text-gray-400 border-b border-gray-700">Magical Log</div>
            <div id="console-output" class="flex-1 overflow-y-auto p-4 space-y-1 console-text text-gray-300">
                <div class="opacity-50">> Awaiting invocation...</div>
            </div>
        </div>

    </div>

    <script src="validator.js"></script>

    <script>
        const testList = document.getElementById('test-list');
        const consoleOutput = document.getElementById('console-output');
        const statusBadge = document.getElementById('status-badge');
        let hasError = false;

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            const time = new Date().toLocaleTimeString('en-US', {hour12:false});
            div.className = type === 'error' ? "text-red-400" : type === 'success' ? "text-green-400" : "text-gray-300";
            div.innerHTML = `<span class="opacity-50">[${time}]</span> ${msg}`;
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function addResult(title, passed, detail) {
            const div = document.createElement('div');
            div.className = `flex justify-between items-center p-3 rounded border ${passed ? "bg-green-900/20 border-green-800" : "bg-red-900/20 border-red-800"}`;
            div.innerHTML = `
                <div>
                    <span class="font-bold ${passed ? 'text-green-400' : 'text-red-400'}">${passed ? 'âœ” PASS' : 'âœ˜ FAIL'}</span>
                    <span class="text-gray-200 ml-2 font-bold">${title}</span>
                </div>
                <div class="text-xs ${passed ? 'text-purple-300' : 'text-red-300'}">${detail}</div>
            `;
            testList.appendChild(div);
            if (!passed) hasError = true;
        }

        async function runTests() {
            testList.innerHTML = '';
            hasError = false;
            statusBadge.className = "px-4 py-2 rounded-lg font-bold bg-blue-600 text-white animate-pulse";
            statusBadge.innerText = "Judging...";
            
            try {
                // 1. æª¢æŸ¥å‡½å¼å­˜åœ¨
                if (typeof validateUsername !== 'function' || typeof validatePassword !== 'function') {
                    throw new Error("æ‰¾ä¸åˆ° validateUsername æˆ– validatePassword å‡½å¼");
                }
                addResult("å‡½å¼å®šç¾©", true, "å’’èªçµæ§‹å®Œæ•´");

                // 2. æ¸¬è©¦ Username
                log("--- é–‹å§‹é©—è­‰çœŸå (Username) ---");
                const uTests = [
                    { val: "Admin123", expect: true, desc: "æ¨™æº–è‹±æ•¸çµ„åˆ" },
                    { val: "hero", expect: true, desc: "ç´”å°å¯«è‹±æ–‡" },
                    { val: "999", expect: true, desc: "ç´”æ•¸å­—" },
                    { val: "Admin_123", expect: false, desc: "åŒ…å«åº•ç·š (ä¸å…è¨±)" },
                    { val: "user name", expect: false, desc: "åŒ…å«ç©ºç™½ (ä¸å…è¨±)" },
                    { val: "user@mail", expect: false, desc: "åŒ…å«ç‰¹æ®Šç¬¦è™Ÿ (ä¸å…è¨±)" },
                    { val: "", expect: false, desc: "ç©ºå­—ä¸²" },
                ];
                
                let uPass = true;
                for(let t of uTests) {
                    const res = validateUsername(t.val);
                    if(res !== t.expect) {
                        uPass = false;
                        log(`[Username Fail] è¼¸å…¥: "${t.val}" / é æœŸ: ${t.expect} / å¯¦éš›: ${res}`, 'error');
                    }
                }
                addResult("çœŸåè¦å‰‡æ¸¬è©¦", uPass, uPass ? "æ‰€æœ‰è‹±æ•¸è¦å‰‡é€šé" : "éƒ¨åˆ†è¦å‰‡æœªé€šé (è«‹æŸ¥çœ‹ Log)");


                // 3. æ¸¬è©¦ Password
                log("--- é–‹å§‹é©—è­‰éˆé­‚å°è¨˜ (Password) ---");
                // è¦å‰‡: >8, å«å¤§å¯«, å«ç‰¹æ®Šç¬¦è™Ÿ
                const pTests = [
                    { val: "Pass123!", expect: false, desc: "å‰›å¥½ 8 å­—å…ƒ (æ‡‰å¤±æ•—ï¼Œéœ€ >8)" }, // æ³¨æ„é¡Œç›®æ˜¯ >8 é‚„æ˜¯ >=8? é¡Œç›®å¯« "é•·åº¦å¿…é ˆ å¤§æ–¼ 8" (Length > 8)
                    { val: "Password123!", expect: true, desc: "æ¨™æº–åˆæ ¼ (é•·åº¦12, æœ‰å¤§å¯«, æœ‰ç¬¦è™Ÿ)" },
                    { val: "password123!", expect: false, desc: "ç¼ºå°‘å¤§å¯«å­—æ¯" },
                    { val: "PASSWORD123!", expect: true, desc: "å…¨å¤§å¯«+ç¬¦è™Ÿ (åˆæ ¼)" }, 
                    { val: "Password123", expect: false, desc: "ç¼ºå°‘ç‰¹æ®Šç¬¦è™Ÿ" },
                    { val: "Pass@word", expect: true, desc: "å‰›å¥½ 9 å­—å…ƒä¸”ç¬¦åˆè¦å‰‡" },
                    { val: "Short!", expect: false, desc: "é•·åº¦ä¸è¶³" },
                ];

                let pPass = true;
                for(let t of pTests) {
                    const res = validatePassword(t.val);
                    if(res !== t.expect) {
                        pPass = false;
                        log(`[Password Fail] è¼¸å…¥: "${t.val}" (${t.desc}) / é æœŸ: ${t.expect} / å¯¦éš›: ${res}`, 'error');
                    }
                }
                addResult("å°è¨˜è¦å‰‡æ¸¬è©¦", pPass, pPass ? "æ‰€æœ‰å¯†ç¢¼å¼·åº¦è¦å‰‡é€šé" : "éƒ¨åˆ†è¦å‰‡æœªé€šé (è«‹æŸ¥çœ‹ Log)");


            } catch (e) {
                log(`åŸ·è¡ŒéŒ¯èª¤: ${e.message}`, 'error');
                addResult("åŸ·è¡ŒéŒ¯èª¤", false, e.message);
            }

            if (!hasError) {
                statusBadge.className = "px-4 py-2 rounded-lg font-bold bg-green-500 text-white";
                statusBadge.innerText = "ğŸ‰ å¥‘ç´„æˆç«‹";
                log("å¯©åˆ¤çµæŸï¼šä½ çš„é©—è­‰é‚è¼¯å®Œç¾ç„¡ç¼ºï¼", 'success');
            } else {
                statusBadge.className = "px-4 py-2 rounded-lg font-bold bg-red-500 text-white";
                statusBadge.innerText = "âš ï¸ å¥‘ç´„ç„¡æ•ˆ";
            }
        }
    </script>
</body>
</html>